#!/bin/bash
# Manage Mariadb-MySQL databases

# Install
 p mariadb mariadb-clients libmariadbclient

 
# Setup 
    sudo systemctl restart mysqld
    sudo systemctl enable mysqld
    mysql_secure_installation   
    # Choose Y for default options
    mysql -u root -p



# Create Database

    # In MySQL console ,   MariaDB [(none)]>
    
    CREATE DATABASE db_name;

    # NOTE: change 'password' to the mysql root user password
    GRANT ALL ON db_name.* TO 'root'@'localhost' IDENTIFIED BY 'password';
 
 
# Switch to the new database 
    USE db_name;


# Create a Table
  CREATE TABLE IF NOT EXISTS table_name (
    Movie_name           varchar(250)       NOT NULL,
    Size                 int(15)            DEFAULT NULL, 
    Resolution_width     int(4)             DEFAULT NULL,
    Resolution_height    int(4)             DEFAULT NULL,
    Watched              varchar(20)        DEFAULT NULL,  
    Notes                varchar(600)       DEFAULT NULL,
    Definition           varchar(4)         DEFAULT NULL,
    PRIMARY KEY(Movie_name)
     );
         
         
         
# Print the columns of our new table
 show columns in table_name;
 
 
# Insert data to table
INSERT INTO table_name (Name,Size_MB,ResWidth,ResHeight,Watched,Notes,Definition) 
VALUES ("$NAME", "$SIZE", "$RES1", "$RES2", "$WATCHED", "$NOTES", "$DEF")
ON DUPLICATE KEY UPDATE 
    Size_MB = "$SIZE",
    ResWidth = "$RES1",
    ResHeight = "$RES2",
    Watched = "$WATCHED",
    Notes = "$NOTES",
    Definition = "$DEF";

 
# View records and entries
 SELECT * FROM table_name;
 
 
# Delete Tables
 DROP TABLE table_name;
 
 
# Show tables in database
 SHOW tables;
 
 
# Execute commands from the terminal
 mysql -u root --password='pass' --database="db_name" --execute="select * from table_name;"
 
 
 
# Enter data from a script
mysql --user=root --password="$DB_PASSWORD" movies << EOF
INSERT INTO movies (Name,Size_MB,ResWidth,ResHeight,Watched,Notes,Definition) 
VALUES ("$NAME", "$SIZE", "$RES1", "$RES2", "$WATCHED", "$NOTES", "$DEF")
ON DUPLICATE KEY UPDATE 
    Size_MB = "$SIZE",
    ResWidth = "$RES1",
    ResHeight = "$RES2",
    Watched = "$WATCHED",
    Notes = "$NOTES",
    Definition = "$DEF";
EOF

 
# Query examples

	select * from table_name where Size='1000' ;
	select * from table_name order by column_name;
	
	# search for files beginning with ASS ( Use an ' not " to make it work)
	select * from table_name where column_name LIKE 'ASS%'; 
	
	# search for files containing ASS
	select * from table_name where column_name LIKE '%ASS%'; 
